{#<!--
Gibbon: the flexible, open school platform
Founded by Ross Parker at ICHK Secondary. Built by Ross Parker, Sandra Kuipers and the Gibbon community (https://gibbonedu.org/about/)
Copyright © 2010, Gibbon Foundation
Gibbon™, Gibbon Education Ltd. (Hong Kong)

This is a Gibbon template file, written in HTML and Twig syntax.
For info about editing, see: https://twig.symfony.com/doc/2.x/

TODO: add template variable details.
-->#}

<!DOCTYPE html>
<html lang="{{ lang }}" dir="{{ rightToLeft ? 'rtl' : 'ltr' }}" style="scroll-behavior: smooth;">
    <head>
        {% block head %}
        {{ include('head.twig.html') }}
        {% endblock head %}
    </head>
        
        {% if isLoggedIn %}
        <body x-data="{ modalOpen: false, modalType: 'none', globalShowHide: false }"
        class="h-full flex flex-col font-sans {{ bodyBackground  ? '' : 'body-gradient-' ~ themeColour|lower }}" style="{{ bodyBackground  ? bodyBackground : '' }} {{ themeColour is empty ? 'background: linear-gradient(to left top, #402568 2%, #935ee1 65%, #a871ec) no-repeat fixed' : '' }}">
        <a id="top"></a>
        {% set sidebarPos = isLoggedIn ? 'left' : 'right' %}
        
        <header id="main-header" class="bg-white/80 backdrop-blur-lg fixed top-0 left-0 right-0 z-50">

        <div class="px-4 sm:px-6 lg:px-12 pb-2 pt-2">

                {% block header %}
                    <div id="header" class="relative flex justify-between items-center" >

                        <a id="header-logo" class="block my-4 max-w-xs sm:max-w-full leading-none" href="{{ absoluteURL }}/main.php"}">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600"><path d="M12 2L2 7l10 5 10-5-10-5z"></path><path d="M2 17l10 5 10-5"></path><path d="M2 12l10 5 10-5"></path></svg>
                            
                        </a>

                        <div class="flex-grow flex items-center justify-end text-right text-sm">
                            <span class="text-2xl font-bold text-gray-900"> &nbsp;TeachNova &nbsp;&nbsp;</span>
                        {% if isLoggedIn %}
                            <nav id="header-menu" class="flex-1 justify-between text-gray-700 no-bold ">
                            {{ include('menu.twig.html') }}
                            </nav>
                        {% endif %}



                <div class="relative flex justify-between items-center bblock px-4 py-2 w-1 h-8 text-xs ">
                <ul x-cloak x-show="menuOpen" x-transition:enter.duration.250ms x-transition:leave.duration.100ms class="list-none m-0 rounded-lg shadow-xl border border-gray-200 font-medium  group-hover:text-blue-700 bg-opacity-75 backdrop-blur-lg backdrop-contrast-125 backdrop-saturate-150 absolute rounded-md w-48 mt-1 p-1 sm:p-1.5 z-50 cursor-pointer {{ rightToLeft ? 'left-0' : 'right-0' }}">
                    {% for link in minorLinks|reverse %}
                    <li class="block px-4 py-2 hover:bg-gray-100 rounded">
                        <a @click="menuOpen = false" href="{{ link.url }}" class="flex justify-between items-center text-sm text-blue-700 no-underline px-1 py-2 md:py-1 leading-normal {{ rightToLeft ? 'text-right' : 'text-left' }}" target="{{ link.target }}" {{ link.target == '_blank' ? 'rel="noopener noreferrer"' : '' }}>
                            {{- link.name|raw -}}

                            {% if link.target == '_blank' %}
                                {{ icon('basic', 'external-link', 'size-4 text-blue-700 text-opacity-80 pointer-events-none') }}
                            {% endif %}
                        </a>
                    </li>
                    {% endfor %}
                </ul>
                </div>

                {% if isLoggedIn and currentUser %}
                    <a href="{{ currentUser.url ?? './index.php?q=/preferences.php' }}" class="hidden sm:block hidden md:inline font-semibold text-gray-700 ">
                        Hi, {{ currentUser.username }}! &nbsp;&nbsp;
                    </a>
                {% endif %}


                <div class="relative px-4 py-4 {{ rightToLeft ? '-ml-3' : '-mr-3' }}" x-data="{menuOpen: false}" @mouseleave="menuOpen = false" @click.outside="menuOpen = false">
                        <a @mouseenter="menuOpen = true" @click="menuOpen = !menuOpen" :class="{'ring-opacity-75': menuOpen, 'ring-opacity-25': !menuOpen}" hx-boost="true" hx-target="#content-wrap" hx-select="#content-wrap" hx-swap="outerHTML show:no-scroll swap:0s" href="{{ currentUser.url ?? '#' }}" class="{{ currentUser.image_240 ? 'flex-none' : 'flex items-center justify-center' }} block overflow-hidden w-10 h-10 rounded-full ring-white ring-2 cursor-pointer">
                        {% if currentUser.image_240 %}
                            <img class="w-full -mt-1" src="{{ absoluteURL }}/{{ currentUser.image_240 }}" />
                        {% else %}
                            {% if isLoggedIn and currentUser %}
                                <img class="w-full" src="https://placehold.co/30x30/2563EB/FFFFFF?text={{ currentUser.name |split(' ')|first|slice(0,1) }}"  />
                            {% endif %}
                        {% endif %}
                        </a>

                        <ul x-cloak x-show="menuOpen" x-transition:enter.duration.250ms x-transition:leave.duration.100ms class="list-none m-0 bg-black bg-opacity-75 backdrop-blur-lg backdrop-contrast-125 backdrop-saturate-150 absolute rounded-md w-48 mt-1 p-1 sm:p-1.5 z-50 cursor-pointer {{ rightToLeft ? 'left-0' : 'right-0' }}">
                            {% for link in minorLinks|reverse %}
                            <li class="hover:bg-{{ themeColour }}-700 rounded">
                                <a @click="menuOpen = false" href="{{ link.url }}" class="flex justify-between items-center text-sm text-white focus:text-{{ themeColour }}-200 no-underline px-1 py-2 md:py-1 leading-normal {{ rightToLeft ? 'text-right' : 'text-left' }}" target="{{ link.target }}" {{ link.target == '_blank' ? 'rel="noopener noreferrer"' : '' }}>
                                    {{- link.name|raw -}}

                                    {% if link.target == '_blank' %}
                                        {{ icon('basic', 'external-link', 'size-4 text-white text-opacity-50 pointer-events-none') }}
                                    {% endif %}
                                </a>
                            </li>
                            {% endfor %}
                        </ul>
                </div>

                {% if currentUser.houseName and currentUser.houseLogo %}
                    <img class="ml-3 -mt-2 w-12 h-12" title="{{ currentUser.houseName }}" style="vertical-align: -75%;" src="{{ absoluteURL }}/{{ currentUser.houseLogo }}"/>
                {% endif %}
            </div>
        </div>

 
        {% endblock %}
        </div>
        </header>
        {% else %}
        <body class="info-panel-gradient">
        {% endif %}
        {% if isLoggedIn %}

        <div id="wrapOuter" class="pt-80 bg-transparent-100">
        {% else %}
        <div id="wrapOuter" class="info-panel-gradient pt-60 height-full">
        {% endif %}

            <div id="wrap" class="px-0 sm:px-6 lg:px-12 -mt-48 ">
                {% block beforePage %}
                {% endblock beforePage %}

                <div class="block lg:hidden mx-4 sm:mx-0 mb-4 ">
                {% for type, alerts in page.alerts %}
                    {% for text in alerts %}
                        <div class="{{ type }}">{{ text|raw }}</div>
                    {% endfor %}
                {% endfor %}
                </div>

                <div id="content-wrap" class="relative w-full min-h-1/2 flex content-start {{ sidebar ? 'gap-4 lg:gap-6 flex flex-col' : 'flex-col' }} {{ sidebarPos == 'left' ? 'lg:flex-row' : 'lg:flex-row-reverse' }} {{ not isHomePage and not isLoggedIn ? 'flex-col-reverse'}} clearfix">

                    {% if sidebar and (sidebarContents or menuModule) %}
                        {% if isLoggedIn %}
                        <div id="sidebar" class="w-full lg:w-sidebar lg:min-w-72 lg:max-w-xs ">
                            {% else %}
                        <div id="sidebar" class="w-full lg:w-sidebar lg:min-w-72 lg:max-w-xl ">
                        {% endif %}
                            {% block sidebar %}
                            {{ include('navigation.twig.html') }}
                            {% endblock sidebar %}
                        </div>


                    {% else %}
                        {{ include('navigation.twig.html') }}
                    {% endif %}

                    <div id="content" class="{{ contentClass ? contentClass : 'max-w-full' }} {{ isHomePage and isLoggedIn ? 'bg-gray-100' : 'info-panel-gradient'}} w-full shadow  sm:rounded lg:flex-1 px-4 sm:px-8">

                        <div id="content-inner" class="h-full">

                            {% block page %}
                                
                                {{ include('page.twig.html') }}

                                {{ content|join("\n")|raw }}
                                
                            {% endblock %}
                        </div>
                    </div>

                </div>
                

                  {% if isLoggedIn %}
                    <div class="text-right mt-2 text-xs pr-1 mb-8">
                        <a class='text-{{ themeColour }}-800' href='#top'>{{ __('Return to top') }}</a>
                    </div>
                {% endif %}
                 
                {% block afterPage %}
                {% endblock afterPage %}
            </div>
            
            {% if isLoggedIn %}
            {% block footer %}
                {# Remove the old footer wrapper and styling #}
                {{ include('footer.twig.html') }}
            {% endblock %}
            {% endif %}

        </div>

        {% if isLoggedIn %}
            {% block privacy %}
            {{ include('privacy.twig.html') }}
            {% endblock privacy %}

            {% block foot %}
            {{ include('foot.twig.html') }}
            {% endblock foot %}
        {% endif %}

    </body>
</html>
